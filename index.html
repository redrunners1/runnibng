<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Mini Geometry Dash</title>
<style>
  body {
    margin: 0;
    background: #000;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }
  canvas {
    background: #111;
    border: 3px solid #0ff;
  }
</style>
</head>
<body>

<canvas id="game" width="800" height="400"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const gravity = 0.9;
const speed = 5;
let level = 0;

const levels = [
  {
    platforms: [{x:0,y:360,w:800,h:40}],
    spikes: [{x:400,y:340,w:40,h:20}],
    goal: {x:760,y:320,w:30,h:40}
  },
  {
    platforms: [
      {x:0,y:360,w:800,h:40},
      {x:200,y:300,w:100,h:20},
      {x:450,y:260,w:100,h:20}
    ],
    spikes: [
      {x:300,y:340,w:40,h:20},
      {x:550,y:340,w:40,h:20}
    ],
    goal: {x:760,y:220,w:30,h:40}
  },
  {
    platforms: [
      {x:0,y:360,w:800,h:40},
      {x:150,y:300,w:120,h:20},
      {x:350,y:250,w:120,h:20},
      {x:550,y:200,w:120,h:20}
    ],
    spikes: [
      {x:250,y:340,w:40,h:20},
      {x:450,y:340,w:40,h:20},
      {x:650,y:340,w:40,h:20}
    ],
    goal: {x:760,y:160,w:30,h:40}
  }
];

let player;

function reset() {
  player = { x:50, y:300, w:30, h:30, dy:0, grounded:false };
}

reset();

document.addEventListener("keydown", e => {
  if ((e.code === "Space" || e.code === "ArrowUp") && player.grounded) {
    player.dy = -15;
    player.grounded = false;
  }
});

function collide(a,b){
  return a.x<b.x+b.w && a.x+a.w>b.x && a.y<b.y+b.h && a.y+a.h>b.y;
}

function update(){
  player.x += speed;
  player.dy += gravity;
  player.y += player.dy;
  player.grounded = false;

  const L = levels[level];

  L.platforms.forEach(p=>{
    if(collide(player,p) && player.dy>=0){
      player.y = p.y - player.h;
      player.dy = 0;
      player.grounded = true;
    }
  });

  L.spikes.forEach(s=>{
    if(collide(player,s)) reset();
  });

  if(collide(player,L.goal)){
    level++;
    if(level>=levels.length){
      alert("You beat the game!");
      level = 0;
    }
    reset();
  }

  if(player.y>canvas.height) reset();
}

function draw(){
  ctx.clearRect(0,0,800,400);

  const L = levels[level];

  ctx.fillStyle="#777";
  L.platforms.forEach(p=>ctx.fillRect(p.x,p.y,p.w,p.h));

  ctx.fillStyle="red";
  L.spikes.forEach(s=>ctx.fillRect(s.x,s.y,s.w,s.h));

  ctx.fillStyle="lime";
  ctx.fillRect(L.goal.x,L.goal.y,L.goal.w,L.goal.h);

  ctx.fillStyle="cyan";
  ctx.fillRect(player.x,player.y,player.w,player.h);

  ctx.fillStyle="white";
  ctx.fillText("Level "+(level+1),10,20);
}

function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>
